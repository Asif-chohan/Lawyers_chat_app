(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{631:function(e,a,t){"use strict";var c=t(1),n=t.n(c),s=function(e){var a=e.conversation,t=e.user;return n.a.createElement("div",{className:"d-flex flex-nowrap chat-item"},n.a.createElement("img",{className:"rounded-circle avatar size-40 align-self-end",src:t.thumb,alt:""}),n.a.createElement("div",{className:"bubble"},n.a.createElement("div",{className:"message"},a.message),n.a.createElement("div",{className:"time text-muted text-right mt-2"},a.sentAt)))},r=function(e){var a=e.conversation;return n.a.createElement("div",{className:"d-flex flex-nowrap chat-item flex-row-reverse"},n.a.createElement("img",{className:"rounded-circle avatar size-40 align-self-end",src:t(87),alt:a.name}),n.a.createElement("div",{className:"bubble jambo-card"},n.a.createElement("div",{className:"message"},a.message),n.a.createElement("div",{className:"time text-muted text-right mt-2"},a.sentAt)))};a.a=function(e){var a=e.conversationData,t=e.selectedUser;return n.a.createElement("div",{className:"chat-main-content"},a.map(function(e,a){return"sent"===e.type?n.a.createElement(r,{key:a,conversation:e}):n.a.createElement(s,{key:a,conversation:e,user:t})}))}},632:function(e,a,t){"use strict";var c=t(1),n=t.n(c),s=function(e){var a=e.chat,t=e.selectedSectionId,c=e.onSelectUser;return n.a.createElement("div",{key:a.id,className:"chat-user-item ".concat(t===a.id?"active":""),onClick:function(){c(a)}},n.a.createElement("div",{className:"chat-user-row row"},n.a.createElement("div",{className:"chat-avatar col-xl-2 col-3"},n.a.createElement("div",{className:"chat-avatar-mode"},n.a.createElement("img",{src:a.thumb,className:"rounded-circle size-40",alt:a.name}),n.a.createElement("span",{className:"chat-mode small ".concat(a.status)}))),n.a.createElement("div",{className:"chat-info col-xl-8 col-6"},n.a.createElement("span",{className:"name h4"},a.name),n.a.createElement("div",{className:"chat-info-des"},a.lastMessage.substring(0,25)+"..."),n.a.createElement("div",{className:"last-message-time"},a.lastMessageTime)),n.a.createElement("div",{className:"chat-date col-xl-2 col-3"},n.a.createElement("div",{className:"bg-primary rounded-circle badge text-white"},a.unreadMessage))))};a.a=function(e){var a=e.chatUsers,t=e.selectedSectionId,c=e.onSelectUser;return n.a.createElement("div",{className:"chat-user"},a.map(function(e,a){return n.a.createElement(s,{key:a,chat:e,selectedSectionId:t,onSelectUser:c})}))}},633:function(e,a,t){"use strict";var c=t(1),n=t.n(c),s=t(284),r=t.n(s),l=function(e){var a=e.onSelectUser,t=e.selectedSectionId,c=e.user;return n.a.createElement("div",{className:"chat-user-item ".concat(t===c._id?"active":""),onClick:function(){return a(c)}},n.a.createElement("div",{className:"chat-user-row row"},n.a.createElement("div",{className:"chat-avatar col-xl-2 col-3"},n.a.createElement("div",{className:"chat-avatar-mode"},n.a.createElement("img",{src:r.a,className:"rounded-circle size-40",alt:"Abbott"}))),n.a.createElement("div",{className:"chat-contact-col col-xl-10 col-9"},n.a.createElement("div",{className:"h4 name"},c.name))))};a.a=function(e){var a=e.onSelectUser,t=e.selectedSectionId,c=e.contactList;return n.a.createElement("div",{className:"chat-user"},c.map(function(e,c){return n.a.createElement(l,{key:c,user:e,selectedSectionId:t,onSelectUser:a})}))}},788:function(e,a,t){"use strict";t.r(a);var c=t(174),n=t(8),s=t(18),r=t(19),l=t(21),o=t(20),i=t(22),m=t(72),d=t(1),u=t.n(d),h=t(38),v=t.n(h),p=t(113),E=t.n(p),f=t(30),N=t(634),g=t.n(N),b=t(169),k=t.n(b),S=t(170),x=t.n(S),C=t(154),w=t.n(C),y=t(114),U=t.n(y),T=t(35),j=t.n(T),O=t(130),R=t.n(O),A=t(116),I=t.n(A),M=t(632),J=t(155),L=(t(631),t(74)),z=t(633),P=t(140),D=t(14),_=t(58),K=t(34),V=t(96),F=t(689),W=t.n(F),q=function(e){function a(){var e;return Object(s.a)(this,a),(e=Object(l.a)(this,Object(o.a)(a).call(this))).filterContact=function(e){return""===e?L.a.filter(function(e){return!e.recent}):L.a.filter(function(a){return!a.recent&&a.name.toLowerCase().indexOf(e.toLowerCase())>-1})},e.filterUsers=function(e){return""===e?L.a.filter(function(e){return e.recent}):L.a.filter(function(a){return a.recent&&a.name.toLowerCase().indexOf(e.toLowerCase())>-1})},e.startCall=function(a){if(e.state.roomName.trim()){console.log("Joining room '"+e.state.roomName+"'...");var t={name:e.state.roomName};e.state.previewTracks&&(t.tracks=e.state.previewTracks),W.a.connect(e.state.token,t).then(e.roomJoined,e.props.sendCall(a,e.state.roomName),function(e){alert("Could not connect to Twilio: "+e.message)})}else e.setState({roomNameErr:!0})},e.receCall=function(){if(e.state.roomName.trim()){console.log("Joining room '"+e.state.roomName+"'...");var a={name:e.state.roomName};e.state.previewTracks&&(a.tracks=e.state.previewTracks),W.a.connect(e.state.token,a).then(e.roomJoined,function(e){alert("Could not connect to Twilio: "+e.message)})}else e.setState({roomNameErr:!0})},e.attachTracks=function(e,a){console.log("================tracks====================",e),e.forEach(function(e){console.log("===================container=================",a),console.log(e.track),a.appendChild(e.track.attach())})},e.attachParticipantTracks=function(a,t){console.log("==========participant=========================="),console.log(a);var c=Array.from(a.tracks.values());console.log("===============tracks=====================",c),e.attachTracks(c,t)},e.detachTracks=function(e){e.forEach(function(e){e.track.detach().forEach(function(e){e.remove()})})},e.detachParticipantTracks=function(a){var t=Array.from(a.tracks.values());e.detachTracks(t)},e.roomJoined=function(a){console.log("Joined as '"+e.state.identity+"'"),e.setState({activeRoom:a,localMediaAvailable:!0,hasJoinedRoom:!0});var t=e.refs.localMedia;console.log("=======previewContainer============================="),console.log(t),console.log("===================================="),t.querySelector("video")||e.attachParticipantTracks(a.localParticipant,t),a.participants.forEach(function(a){console.log("Already in Room: '"+a.identity+"'");var t=e.refs.remoteMedia;e.attachParticipantTracks(a,t)}),a.on("participantConnected",function(e){console.log("Joining: '"+e.identity+"'")}),a.on("trackAdded",function(a,t){console.log(t.identity+" added track: "+a.kind);var c=e.refs.remoteMedia;e.attachTracks([a],c)}),a.on("trackRemoved",function(a,t){console.log(t.identity+" removed track: "+a.kind),e.detachTracks([a])}),a.on("participantDisconnected",function(a){console.log("Participant '"+a.identity+"' left the room"),e.detachParticipantTracks(a)}),a.on("disconnected",function(){e.state.previewTracks&&e.state.previewTracks.forEach(function(e){e.stop()}),e.detachParticipantTracks(a.localParticipant),a.participants.forEach(e.detachParticipantTracks),e.state.activeRoom=null,e.setState({hasJoinedRoom:!1,localMediaAvailable:!1})})},e.leaveRoom=function(){e.state.activeRoom.disconnect(),e.setState({hasJoinedRoom:!1,localMediaAvailable:!1})},e.Communication=function(){e.props.incomingCall;var a=e.state,t=a.message,c=a.selectedUser;a.conversation;console.log("selecteduser",c);var n=e.state.localMediaAvailable?u.a.createElement("div",{className:"flex-item"},u.a.createElement("div",{ref:"localMedia"})):"";return u.a.createElement("div",{className:"chat-main"},u.a.createElement("div",{className:"chat-main-header"},u.a.createElement(j.a,{className:"d-block d-xl-none chat-btn","aria-label":"Menu",onClick:e.onToggleDrawer.bind(Object(m.a)(Object(m.a)(e)))},u.a.createElement("i",{className:"zmdi zmdi-comment-text"})),u.a.createElement("div",{className:"chat-main-header-info"},u.a.createElement("div",{className:"chat-avatar mr-2"},u.a.createElement("div",{className:"chat-avatar-mode"},u.a.createElement("img",{src:c.thumb,className:"rounded-circle size-60",alt:""}),u.a.createElement("span",{className:"chat-mode ".concat(c.status)}))),u.a.createElement("div",{className:"chat-contact-name"},c.name))),u.a.createElement(_.a,{className:"chat-list-scroll scrollbar",style:{height:e.props.width>=1200?"calc(100vh - 300px)":"calc(100vh - 255px)"}},u.a.createElement("div",{className:"flex-container"},n,u.a.createElement("div",{className:"flex-item",ref:"remoteMedia",id:"remote-media"}))),u.a.createElement("div",{className:"chat-main-footer"},u.a.createElement("div",{className:"d-flex flex-row align-items-center",style:{maxHeight:51}},u.a.createElement("div",{className:"col"},u.a.createElement("div",{className:"form-group"},u.a.createElement("textarea",{id:"required",className:"border-0 form-control chat-textarea",onKeyUp:e._handleKeyPress.bind(Object(m.a)(Object(m.a)(e))),onChange:e.updateMessageValue.bind(Object(m.a)(Object(m.a)(e))),value:t,placeholder:"Type and hit enter to send message"}))),u.a.createElement("div",{className:"chat-sent"},u.a.createElement(j.a,{onClick:function(){return e.startCall(c)},"aria-label":"Send message"},u.a.createElement("i",{className:"zmdi  zmdi-mail-send"}))))))},e.AppUsersInfo=function(){return u.a.createElement("div",{className:"chat-sidenav-main"},u.a.createElement("div",{className:"bg-grey lighten-5 chat-sidenav-header"},u.a.createElement("div",{className:"chat-user-hd mb-0"},u.a.createElement(j.a,{className:"back-to-chats-button","aria-label":"back button",onClick:function(){e.setState({userState:1})}},u.a.createElement("i",{className:"zmdi zmdi-arrow-back"}))),u.a.createElement("div",{className:"chat-user chat-user-center"},u.a.createElement("div",{className:"chat-avatar mx-auto"},u.a.createElement("img",{src:t(87),className:"avatar avatar-shadow rounded-circle size-60 huge",alt:"John Doe"})),u.a.createElement("div",{className:"user-name h4 my-2"},"Robert Johnson"))),u.a.createElement("div",{className:"chat-sidenav-content"},u.a.createElement(_.a,{className:"chat-sidenav-scroll scrollbar",style:{height:e.props.width>=1200?"calc(100vh - 328px)":"calc(100vh - 162px)"}},u.a.createElement("form",{className:"p-4"},u.a.createElement("div",{className:"form-group mt-4"},u.a.createElement("label",null,"Mood"),u.a.createElement(R.a,{fullWidth:!0,id:"exampleTextarea",multiline:!0,rows:3,onKeyUp:e._handleKeyPress.bind(Object(m.a)(Object(m.a)(e))),onChange:e.updateMessageValue.bind(Object(m.a)(Object(m.a)(e))),defaultValue:"it's a status....not your diary...",placeholder:"Status",margin:"none"}))))))},e.ChatUsers=function(){return u.a.createElement("div",{className:"chat-sidenav-main"},u.a.createElement("div",{className:"chat-sidenav-header"},u.a.createElement("div",{className:"chat-user-hd"},u.a.createElement("div",{className:"chat-avatar mr-3",onClick:function(){e.setState({userState:2})}},u.a.createElement("div",{className:"chat-avatar-mode"},u.a.createElement("img",{id:"user-avatar-button",src:t(87),className:"rounded-circle size-50",alt:""}),u.a.createElement("span",{className:"chat-mode online"}))),u.a.createElement("div",{className:"module-user-info d-flex flex-column justify-content-center"},u.a.createElement("div",{className:"module-title"},u.a.createElement("h5",{className:"mb-0"},"Robert Johnson")),u.a.createElement("div",{className:"module-user-detail"},u.a.createElement("span",{className:"jr-link text-grey"},"robert@example.com")))),u.a.createElement("div",{className:"search-wrapper"},u.a.createElement(P.a,{placeholder:"Search or start new chat",onChange:e.updateSearchChatUser.bind(Object(m.a)(Object(m.a)(e))),value:e.state.searchChatUser}))),u.a.createElement("div",{className:"chat-sidenav-content"},u.a.createElement(k.a,{position:"static",className:"no-shadow chat-tabs-header"},u.a.createElement(x.a,{className:"chat-tabs",value:e.state.selectedTabIndex,onChange:e.handleChange,indicatorColor:"primary",textColor:"primary",variant:"fullWidth"},u.a.createElement(w.a,{label:u.a.createElement(D.a,{id:"chat.chatUser"})}),u.a.createElement(w.a,{label:u.a.createElement(D.a,{id:"chat.contacts"})}))),u.a.createElement(g.a,{index:e.state.selectedTabIndex,onChangeIndex:e.handleChangeIndex},u.a.createElement(_.a,{className:"chat-sidenav-scroll scrollbar",style:{height:e.props.width>=1200?"calc(100vh - 328px)":"calc(100vh - 202px)"}},0===e.state.chatUsers.length?u.a.createElement("div",{className:"p-5"},e.state.userNotFound):u.a.createElement(M.a,{chatUsers:e.state.chatUsers,selectedSectionId:e.state.selectedSectionId,onSelectUser:e.onSelectUser.bind(Object(m.a)(Object(m.a)(e)))})),u.a.createElement(_.a,{className:"chat-sidenav-scroll scrollbar",style:{height:e.props.width>=1200?"calc(100vh - 328px)":"calc(100vh - 202px)"}},0===e.state.contactList.length?u.a.createElement("div",{className:"p-5"},e.state.userNotFound):u.a.createElement(z.a,{contactList:e.state.contactList,selectedSectionId:e.state.selectedSectionId,onSelectUser:e.onSelectUser.bind(Object(m.a)(Object(m.a)(e)))})))))},e._handleKeyPress=function(a){"Enter"===a.key&&e.submitComment()},e.handleChange=function(a,t){e.setState({selectedTabIndex:t})},e.handleChangeIndex=function(a){e.setState({selectedTabIndex:a})},e.onSelectUser=function(a){e.setState({loader:!0,selectedSectionId:a._id,drawerState:e.props.drawerState,selectedUser:a,conversation:e.state.conversationList.find(function(e){return e.id===a._id})}),setTimeout(function(){e.setState({loader:!1})},1500)},e.showCommunication=function(){return u.a.createElement("div",{className:"chat-box"},u.a.createElement("div",{className:"chat-box-main"},null===e.state.selectedUser?u.a.createElement("div",{className:"loader-view",style:{height:"calc(100vh - 120px)"}},u.a.createElement("i",{className:"zmdi zmdi-comment s-128 text-muted"}),u.a.createElement("h1",{className:"text-muted"},u.a.createElement(D.a,{id:"chat.selectUserChat"})),u.a.createElement(v.a,{className:"d-block d-xl-none",color:"primary",onClick:e.onToggleDrawer.bind(Object(m.a)(Object(m.a)(e)))},u.a.createElement(D.a,{id:"chat.selectContactChat"}))):e.Communication()))},e.state={loader:!1,userNotFound:"No user found",drawerState:!1,selectedSectionId:"",selectedTabIndex:0,userState:1,searchChatUser:"",contactList:[],selectedUser:null,message:"",chatUsers:L.a.filter(function(e){return e.recent}),conversationList:J.a,conversation:null,identity:null,roomName:"new room",roomNameErr:!1,previewTracks:null,localMediaAvailable:!1,hasJoinedRoom:!1,activeRoom:""},e}return Object(i.a)(a,e),Object(r.a)(a,[{key:"submitComment",value:function(){var e=this;if(""!==this.state.message){var a=this.state.conversation.conversationData.concat({type:"sent",message:this.state.message,sentAt:I()().format("hh:mm:ss A")});this.setState({conversation:Object(n.a)({},this.state.conversation,{conversationData:a}),message:"",conversationList:this.state.conversationList.map(function(t){return t.id===e.state.conversation.id?Object(n.a)({},e.state.conversation,{conversationData:a}):t})})}}},{key:"updateMessageValue",value:function(e){this.setState({message:e.target.value})}},{key:"updateSearchChatUser",value:function(e){this.setState({searchChatUser:e.target.value,contactList:this.filterContact(e.target.value),chatUsers:this.filterUsers(e.target.value)})}},{key:"onToggleDrawer",value:function(){this.setState({drawerState:!this.state.drawerState})}},{key:"componentDidMount",value:function(){if(this.props.receCall(),"done"===this.props.getAllStatus?this.setState({contactList:this.props.allUsers}):this.props.getAllUsers(),"done"===this.props.getTokanStatus){var e=this.props.tokan,a=e.identity,t=e.token;this.setState({identity:a,token:t})}}},{key:"componentWillReceiveProps",value:function(e){"done"===e.getAllStatus&&this.setState({contactList:this.props.allUsers}),e.incomingCall&&this.setState({roomName:e.incomingRoomName})}},{key:"render",value:function(){var e=this.props.incomingCall,a=this.state.localMediaAvailable?u.a.createElement("div",{className:"flex-item"},u.a.createElement("div",{ref:"localMedia"})):"",t=(this.state.hasJoinedRoom?u.a.createElement("button",{label:"Leave Room",secondary:!0,onClick:this.leaveRoom}):u.a.createElement("button",{label:"Join Room",primary:!0,onClick:this.joinRoom}),this.state),c=t.loader,n=t.userState,s=t.drawerState;return u.a.createElement("div",{className:"app-wrapper app-wrapper-module"},u.a.createElement("div",{className:"app-module chat-module animated slideInUpTiny animation-duration-3"},u.a.createElement("div",{className:"chat-module-box"},u.a.createElement("div",{className:"d-block d-xl-none"},a,u.a.createElement(E.a,{open:s,onClose:this.onToggleDrawer.bind(this)},1===n?this.ChatUsers():this.AppUsersInfo())),e?u.a.createElement("button",{onClick:this.receCall},"Receive call"):u.a.createElement("p",null),u.a.createElement("div",{className:"chat-sidenav d-none d-xl-flex"},1===n?this.ChatUsers():this.AppUsersInfo()),c?u.a.createElement("div",{className:"loader-view w-100",style:{height:"calc(100vh - 120px)"}},u.a.createElement(U.a,null)):this.showCommunication())))}}]),a}(d.Component);a.default=Object(f.c)(function(e){var a;return a={width:e.settings.width,allUsers:e.userReducer.allUsers,getAllStatus:e.userReducer.getAllStatus,loader:e.userReducer.loader,getTokanStatus:e.chatReducer.getTokanStatus,tokan:e.chatReducer.tokan},Object(c.a)(a,"loader",e.chatReducer.loader),Object(c.a)(a,"incomingCall",e.chatReducer.incomingCall),Object(c.a)(a,"incomingRoomName",e.chatReducer.incomingRoomName),a},{getAllUsers:K.k,sendCall:V.e,receCall:V.d})(q)}}]);
//# sourceMappingURL=3.89d1d0f1.chunk.js.map